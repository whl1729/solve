# Q74 JavaScript 如何调用其他JavaScript脚本中的函数？

## 版本说明

| 作者 | 时间 | 版本 | 描述 |
| ---- | ---- | ---- | ---- |
| 伍华龙 | 2021-07-03 | 1.0.0 | 初稿 |

## 解答

- 这个问题主要是模块导入和导出的问题。目前有两种主要的方案：CommonJs和ES6规范分别定义的模块功能。
- CommonJs的模块主要用于服务器。通过`require()` 来导入模块，通过`exports`来导出模块。
- ES6的模块可以用于浏览器和服务器。通过`import`来导入模块，通过`export`来导出模块。
- 目前node默认使用的模块格式是CommonJs，如果需要支持ES6模块，需要通过Babel这样的转码器。

### 《JavaScript高级程序设计》第26章「模块」

- 模块模式
  - 在 ECMAScript 6 模块规范出现之前，虽然浏览器原生不支持模块的行为，但迫切需要这样的行为。
  - ECMAScript 同样不支持模块，因此希望使用**模块模式**的库或代码库必须基于 JavaScript 的语法和词法特性“伪造”出类似模块的行为。
  - 将代码拆分成独立的块，然后再把这些块连接起来可以通过模块模式来实现。
  - 这种模式背后的思想很简单：把逻辑分块，各自封装，相互独立，每个块自行决定对外暴露什么，同时自行决定引入执行哪 些外部代码。 

- CommonJS
  - CommonJS 规范概述了同步声明依赖的模块定义。这个规范主要用于在服务器端实现模块化代码组织，但也可用于定义在浏览器中使用的模块依赖。 CommonJS 模块语法不能在浏览器中直接运行。
  - 一般认为，Node.js的模块系统使用了 CommonJS 规范，实际上并不完全正确。Node.js 使用了轻微修改版本的 CommonJS，因为 Node.js 主要在服务器环境下使用，所以不需要考虑网络延迟问题。
  - CommonJS 模块定义需要使用 require()指定依赖，而使用 exports 对象定义自己的公共 API。

- ES6 模块
  - ES6 最大的一个改进就是引入了模块规范。
  - ECMAScript 6 模块是作为一整块 JavaScript 代码而存在的。
  - 带有 type="module"属性的 `<script>` 标签会告诉浏览器相关代码应该作为模块执行，而不是作为传统的脚本执行。

### 《ES6 入门教程》「模块」一章

- 在ES6之前，社区制定了一些模块加载方案，最主要的有CommonJS和AMD两种。前者用于服务器，后者用于浏览器。
- ES6在语言规格的层面上，实现了模块功能，而且实现得相当简单，完全可以取代现有的CommonJS和AMD规范，成为浏览器和服务器通用的模块解决方案。 
- ES6模块的设计思想，是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。
- CommonJS和AMD模块，都只能在运行时确定这些东西。比如，CommonJS模块就是对象， 输入时必须查找对象属性。
- 浏览器使用ES6模块的语法如下。
  ```html
  <script type="module" src="foo.js"></script>
  ```
- Node的默认模块格式是CommonJS，目前还没决定怎么支持ES6模块。所以，只能通过Babel这样的转码器，在Node里面使用ES6模块。

## 思路

- [x] 先通过wiki和MDN简单了解 JavaScript 的函数调用、包管理机制
  - wiki 和 MDN 都没提到这部分内容
- [x] 看看《JavaScript 高级程序设计》
  - 介绍了CommonJS和ES6两种规范定义的模块使用方法
- [ ] 看看node.js关于模块方面的教程
- [ ] 看看《ES6入门教程》关于模块方面的教程
- [ ] 如何运行JavaScript脚本？
